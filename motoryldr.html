[accordion_item title="Motor y LDR"]

<p>Empezamos por analizar el esquematico de ambos desafios y notar los pines que se ultilizan:</p>
<h2>Hardware</h2>

<h3>Motor:</h3>

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/motor.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/motor.png" alt="Motor" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<p>Utiliza el puerto 1 del shield de motores.</p>

<h3>LDR:</h3>

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/LDRySpeaker.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/LDRySpeaker.png" alt="LDR y Speaker" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<p>Utiliza los 5V y el GND para alimentar el LDR y el parlante.<br>
Tambien utiliza los pins analogicos: El A0 esta conecta conectado al LDR y el A1 esta conectado al parlante.<br>
Dado que no vamos a utilizar el parlante, podemos sacarlo, liberando el pin Analogico A0.<br></p>

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/ldr_sinspeaker.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/ldr_sinspeaker.png" alt="LDR sin speaker" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<p>Debemos utilizar el shield, asi que desconectamos los cables del Arduino, coloquemos el shield y volvamos a conectar los cables, 5V, GND y ya que A0 ahora esta libre, vamos a conectar ahi nuestro LDR.<br>
*NOTA: Muchos shields cuentan con mas pins de los que vienen "habilitados" cuando los compramos y necesitaremos soldar nosotros los "pins hembra" en los cuales podemos conectar para no perder funcionalidades de nuestro Arduino al conectar el shield.*<br>
</p>

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/ldr_conshield.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/ldr_conshield.png" alt="LDR con shield" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<p>Finalmente conectamos el motor en el puerto 1</p>

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/motoryldr.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/motoryldr.png" alt="Motor y LDR" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<h2>Software</h2>

<p>Vamos a ver la estructura del codigo de cada desafio primero y luego veremos como combinarlos para lograr nuestro objetivo.</p>

<h3>Estructura del sketch Motor</h3>

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/motor_sections.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/motor_sections.png" alt="Motor Secciones" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<h3>Estructura del sketch LDR</h3>

![img](/motoryldr/img/ldr_sections.png)
<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/ldr_sections.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/ldr_sections.png" alt="LDR Secciones" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<h3>Nuevo sketch</h3>

<p>Vamos a crear un nuevo sketch y comenzar por copiar las definiciones de variables y los includes de las librerias del motor:<br>
*NOTA: Lo importante a la hora de combinar estos códigos es respetar a que seccion del codigo pertenecen.*</p>

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_0_sections.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_0_sections.png" alt="Nuevo Sketch 0" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

Miremos ahora en detalle las definiciones de variables del código del LDR, la mayoria hacen referencia al parlante y la parte musical, nosotros solo necesitamos lo relacionado al LDR:

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_1_sections.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_1_sections.png" alt="Nuevo Sketch 1" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<p>Agregamos las definiciones a nuestro nuevo sketch:</p>

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_2_sections.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_2_sections.png" alt="Nuevo Sketch 2" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<p>Ahora vamos con los setups de los desafios! El del Motor es facil, copiamos las dos lineas al nuevo sketch.</p>

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_3_sections.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_3_sections.png" alt="Nuevo Sketch 3" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<p>En el LDR solo necesitamos el serial.begin() que nos servira para escribir valor en la consola serial.</p>

![img](/motoryldr/img/monitor_serie_boton.png)
<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/monitor_serie_boton.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/monitor_serie_boton.png" alt="Monitor Serie Boton" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

</p>*NOTA: dentro de la IDE de Arduino. Tenemos la consola serial, que se abre clickeando el icono de la lupa en la esquina superior derecha de la aplicacion.<br>
Esta consola es especialmente util para calibrar y detectar errores en nuestros programas.*<br>
Asi nos deberia quedar el código con el nuevo setup:<br></p>

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_4_sections.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_4_sections.png" alt="Nuevo Sketch 5" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<p>Pasemos ahora a la ultima seccion, el Loop.<br>
Para lograr nuestro objetivo, necesitamos que el motor gire constantemente y que podamos controlar su velocidad con el LDR.<br>
Asi que vamos a empezar por ubicar las partes del código del loop del LDR que se encargan de obtener el valor sensado:</p>

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_6_sections.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_6_sections.png" alt="Nuevo Sketch 6" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<p>Ahora veamos el loop del motor, necesitamos encontrar lo que hace que el motor gire!</p>

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_5_sections.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_5_sections.png" alt="Nuevo Sketch 5" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<p>Combinemos ambos códigos en nuestro nuevo sketch:</p>

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_7_sections.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_7_sections.png" alt="Nuevo Sketch 7" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<p>*NOTA: La funcion Map se utiliza frecuentemente para "normalizar" valores. en este caso, el LDR mide valores que van entre 380 y 980. Y la velocidad del motor se controla con valores entre 0 y 255, para resolver esta conversion que debemos realizar, utilizamos la funcion map().*</p>

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_8_sections.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_8_sections.png" alt="Nuevo Sketch 8" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<p>Necesitamos definir una nueva variable que contenga el valor "normalizado" del LDR, podriamos llamarla "valorSensor".</p>

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_9_sections.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_9_sections.png" alt="Nuevo Sketch 9" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<p>Vamos a mover el "motor.speed()" que tenemos en el setup y lo vamos a ubicar justo luego de normalizar el valor del LDR y lo utilizaremos como parametro para indicar la velocidad.</p>

<p style="text-align: center;">
<a href="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_10_sections.png" target="_blank" rel="noreferrer noopener">
  <img src="https://educacion.camba.coop/pluginfile.php/160/mod_folder/content/0/combinar_desafios/motoryldr/newsketch_10_sections.png" alt="Nuevo Sketch 10" width="800" height="534" class="atto_image_button_text-bottom"></a>
</p>

<p>Luego de refactorizar un poco, el código queda asi:</p>

```
<div class="codigoMotoryldr">LOADING...</div>
```
<p>
[columns] [column size="4"] [button link="https://gitlab.camba.coop/educacion/combinar-desafios/tree/master/motoryldr" type="primary" icon="fa-github" fw="0" target="_blank" rel="noopener noreferrer"]Ver repo[/button] [/column] [column size="4"][/column]
[column size="4"][/column] [/columns] [gap size="10"][/gap] [line][/line] [/accordion_item]
